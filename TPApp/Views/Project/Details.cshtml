@model TPApp.Entities.Project

@{
    ViewData["Title"] = "Chi tiết dự án: " + Model.ProjectName;
    var statuses = ViewBag.Statuses as Dictionary<string, int>;
    var userRole = (int)ViewBag.UserRole; // 1: Buyer, 2: Seller, 3: Consultant
}

<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>@ViewData["Title"]</h2>
        <span class="badge bg-secondary">Role: @(userRole == 1 ? "Buyer" : userRole == 2 ? "Seller" : "Consultant")</span>
    </div>

    <div class="row">
        <div class="col-md-12">
            <div class="card shadow-sm">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0">Tiến trình chuyển giao công nghệ</h5>
                </div>
                <div class="card-body">
                    <div class="list-group">
                        <!-- Step 1: Tech Transfer -->
                        @{ var s1 = statuses["TechTransfer"]; }
                        <a href="@Url.Action("Details", "TechTransfer", new { id = Model.Id })" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                            1. Yêu cầu chuyển giao công nghệ
                            <span class="badge bg-@(s1 > 0 ? "success" : "secondary")">@(s1 > 0 ? "Completed" : "Pending")</span>
                        </a>

                        <!-- Step 2: NDA -->
                        @{ var s2 = statuses["NDA"]; }
                        <a href="@Url.Action("Create", "NDA", new { projectId = Model.Id })" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                            2. Thỏa thuận bảo mật (NDA)
                            <span class="badge bg-@(s2 > 0 ? "success" : "secondary")">@(s2 > 0 ? "Completed" : "Pending")</span>
                        </a>

                        <!-- Step 3: RFQ -->
                         @{ var s3 = statuses["RFQ"]; }
                        <a href="@Url.Action("Create", "RFQ", new { projectId = Model.Id })" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                            3. Yêu cầu báo giá (RFQ)
                            <span class="badge bg-@(s3 > 0 ? "success" : "secondary")">@(s3 > 0 ? "Completed" : "Pending")</span>
                        </a>

                        <!-- Step 4: Proposal -->
                         @{ var s4 = statuses["Proposal"]; }
                        <a asp-controller="Proposal" asp-action="Index" asp-route-duAnId="@Model.Id" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                            4. Nộp hồ sơ đề xuất
                            <span class="badge bg-@(s4 > 0 ? "success" : "secondary")">@(s4 > 0 ? "Completed" : "Pending")</span>
                        </a>

                        <!-- Step 5: Negotiation -->
                         @{ var s5 = statuses["Negotiation"]; }
                        <a href="@Url.Action("Create", "Negotiation", new { projectId = Model.Id })" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                             5. Đàm phán thương mại
                            <span class="badge bg-@(s5 > 0 ? "success" : "secondary")">@(s5 > 0 ? "Completed" : "Pending")</span>
                        </a>

                        <!-- Step 6: EContract -->
                         @{ var s6 = statuses["EContract"]; }
                        <a href="@Url.Action("Create", "EContract", new { projectId = Model.Id })" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                            6. Ký hợp đồng điện tử (E-Contract)
                            <span class="badge bg-@(s6 > 0 ? "success" : "secondary")">@(s6 > 0 ? "Completed" : "Pending")</span>
                        </a>

                        <!-- Step 7: Advance Payment -->
                         @{ var s7 = statuses["AdvancePayment"]; }
                        <a href="@Url.Action("Create", "AdvancePayment", new { projectId = Model.Id })" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                             7. Xác nhận tạm ứng
                            <span class="badge bg-@(s7 > 0 ? "success" : "secondary")">@(s7 > 0 ? "Completed" : "Pending")</span>
                        </a>

                        <!-- Step 8: Implementation Log -->
                         @{ var s8 = statuses["ImplementationLog"]; }
                        <a href="@Url.Action("Create", "ImplementationLog", new { projectId = Model.Id })" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                             8. Nhật ký triển khai
                            <span class="badge bg-@(s8 > 0 ? "success" : "secondary")">@(s8 > 0 ? "Completed" : "Pending")</span>
                        </a>

                        <!-- Step 9: Handover -->
                         @{ var s9 = statuses["Handover"]; }
                        <a href="@Url.Action("Create", "Handover", new { projectId = Model.Id })" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                             9. Biên bản bàn giao
                            <span class="badge bg-@(s9 > 0 ? "success" : "secondary")">@(s9 > 0 ? "Completed" : "Pending")</span>
                        </a>

                        <!-- Step 10: Acceptance -->
                         @{ var s10 = statuses["Acceptance"]; }
                        <a href="@Url.Action("Create", "Acceptance", new { projectId = Model.Id })" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                             10. Biên bản nghiệm thu
                            <span class="badge bg-@(s10 > 0 ? "success" : "secondary")">@(s10 > 0 ? "Completed" : "Pending")</span>
                        </a>

                        <!-- Step 11: Liquidation -->
                         @{ var s11 = statuses["Liquidation"]; }
                        <a href="@Url.Action("Create", "Liquidation", new { projectId = Model.Id })" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                             11. Thanh lý hợp đồng
                            <span class="badge bg-@(s11 > 0 ? "success" : "secondary")">@(s11 > 0 ? "Completed" : "Pending")</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
