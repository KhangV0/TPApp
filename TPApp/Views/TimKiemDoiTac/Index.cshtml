@model TPApp.ViewModel.TimKiemDoiTacIndexVm

<div class="columns-container">
    <div class="container" id="columns">
        <div class="row">

            <!-- CENTER COLUMN -->
            <div class="center_column col-xs-12 col-sm-9" id="center_column">

                @foreach (var cate in Model.Categories)
                {
                    <div class="brand-showcase">
                        <h2 class="brand-showcase-title">
                            <a href="@cate.Url">@cate.Title</a>
                            <span class="icon-title">
                                <img alt="trademark" src="https://techport.vn/FrontEnd/assets/data/icon-title.png" />
                            </span>
                        </h2>

                        <div class="brand-showcase-box">
                            <div class="brand-showcase-content">
                                <div class="brand-showcase-content-tab active">
                                    <div class="row">
                                        <div class="col-md-12 box-pro-list">
                                            <ul class="row product-list grid">

                                                @foreach (var p in cate.Products)
                                                {
                                                    <li class="col-sx-12 col-sm-3 ListProductMobile">
                                                        <div class="product-container">

                                                            <div class="left-block">
                                                                <a href="@p.Url">
                                                                    <img src="@p.ImageUrl"
                                                                         class="img-responsive ProductListImage"
                                                                         alt="@p.TenSanPham"
                                                                         style="height:170px;max-width:none;" />
                                                                </a>

                                                                <div class="add-to-cart">
                                                                    <form method="post" action="@Url.Action("AddToCart", "Cart")">
                                                                        <input type="hidden" name="productId" value="@p.TimDoiTacId" />
                                                                        <button type="submit" class="btn btn-link">
                                                                            Thêm vào giỏ hàng
                                                                        </button>
                                                                    </form>
                                                                </div>
                                                            </div>

                                                            <div class="right-block">
                                                                <h5 class="product-name">
                                                                    <a href="@p.Url">
                                                                        @(p.TenSanPham.Length > 30
                                                                                                                                        ? p.TenSanPham.Substring(0, 30) + "..."
                                                                                                                                        : p.TenSanPham)
                                                            </a>
                                                        </h5>

                                                                <p class="LienHeTimKiemDT">
                                                                    Liên hệ: @p.FullName
                                                                </p>

                                                                <!-- STAR RATING -->
                                                                <div id="stars-sp" style="color:gold;font-size:medium">
                                                            @{
                                                                        var rawStar = p.Rating ?? 0;

                                                                        // Chặn mọi giá trị lỗi: âm / >5
                                                                        var safeStar = rawStar;
                                                                        if (safeStar < 0) safeStar = 0;
                                                                        if (safeStar > 5) safeStar = 5;

                                                                        var stars = new string('★', safeStar)
                                                                        + new string('☆', 5 - safeStar);
                                                                    }
                                                                    @stars

                                                                </div>
                                                            </div>

                                                        </div>
                                                    </li>
                                                }

                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                }

            </div>
            <!-- END CENTER -->
            <!-- RIGHT COLUMN -->
            <div class="column col-xs-12 col-sm-3" id="left_column">
                <div class="adv-banner left-module">
                    <div class="box-adv">
                        <a href="@Html.($"{MainDomain}phieu-tim-kiem-doi-tac.html")">
                            <img src="@Html.($"{MainDomain}FrontEnd/assets/data/img-searchdoitac.jpg")"
                                 alt="ads-banner" />
                        </a>
                    </div>

                    @* @await Html.PartialAsync("_Left") *@
                </div>
            </div>
            <!-- END RIGHT -->

        </div>
    </div>
</div>
